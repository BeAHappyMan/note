

对于一些覆盖面积广或者门墙障碍物较多的需要网络覆盖的场所，单个路由器的信号难以覆盖到各个角落，多个路由器中继是一种能够Wi-Fi覆盖率的有效方式。A wireless repeater  refers a device that takes an existing signal from a wireless routeror wireless access point and rebroadcasts it to create a second network。相比于有线中继，无线中继不需要网线，更加灵活，因而渐渐成为了用户首选。

然而，在中继的过程中，会发生带宽失真的现象。Since only one wireless device can transmit at once, wireless transmissions are doubled (router to the repeater and then repeater to the client versus just router to the client), and so Wireless throughput is reduced by at least 50%. Furthermore, the quality of the connection to an extender is generally worse than if connected to the host access point.

现在越来越多的路由器设备支持双频发送数据，也就是2.4GHz和5Ghz。相比之下，2.4GHz穿墙能力更强，5Ghz抗干扰能力更强。用户可以根据自己的需求选择合适的频段进行中继。但双频路由器并没有提升中继带宽。如果能将两个频段的Wi-Fi融合中继，相比较于单频中继，路由器级联网络将更加稳定和高效。然而由于无线链路存在链路质量差异，需要制订一套合理的调度传输策略，才能充分利用双链路的传输带宽，避免质量差的链路拖累质量好的链路。

受到这样的启发，我们提出了，通过融合两条链路中继进而提高带宽。核心思想是，在ont侧，对每N个数据包进行一次调度，根据等待时间选择合适的链路发送数据包。

具体而言，本文的工作包括以下四点：

为了准备评估链路质量，我们提出了链路快慢因子用以计算数据包发送时间，并利用 卡尔曼滤波器对带宽进行预测。

为了选择合适的分组数据包大小，我们根据当前吞吐量，使用启发式的算法动态调整分组数据包大小。

为了减少双频发送导致的乱序，我们对数据包标号整序，并使用tcp代理技术减少乱序导致的发送降速。

我们在正式环境中实现了 并将其与其他方法作对比，验证 可以提高中继带宽。



相关工作



overview

链路质量感知与预估

网关路由器和中继路由器之间双频汇聚的场景可抽象成如图所示模型，发送方和接收方有两条链路link1、link2，其中c1 和c2 分别代表link1 和link2 的信道容量，h1 和h2 代表可观测的信道质量参数矩阵。无线环境经常受波动、多径衰落、移动性和竞争干扰的影响，信道容量一直处于变化之中，无法提前预知，因此信道容量c 需要通过信道质量参数h 来进行表征。一方面如何选择参数进行表征是需要考虑的问题，另一方面，链路质量会存在波动导致质量参数的观测存在误差，需要对参数观测值采取一定手段进行修正。

本文综合考虑各链路拥塞长度和链路服务时间，提出了链路快慢因子，在此基础上利用卡尔曼滤波器修正链路服务时间，更好地评估链路质量。



在对数据包的决策过程中，每来一组数据包，就进行一次链路决策，只对首包进行决策，分组的其他数据包的传输链路和首包保持一致。在这过程中，分组的大小是需要考虑的一个问题，分组个数太小，同一个业务流的数据链路切换会较为频繁，不能充分利用 802.11 底层的聚合机制，可能导致乱序较多吞吐量难以提升，另外，分组个数太小也就意味着调度算法执行次数越多，将会增加路由器 CPU 的负担。但是，分组数目也不能太大，数目过大将无法及时对链路质量变化做出调度调整，会导致难以做到负载均衡。

本文实时监控聚合链路可用容量变化动态调整调度分组的大小 ，当链路容量降低较多时，减小下一周期的调度分组数目，当链路容量提升较多时，增大下一周期的调度分组数目，从而提升总吞吐性能。  

  

双频发送以及无线环境的不稳定因素，数据包到达中继路由器时难以避免存在乱序现象，乱序的出现对于 TCP 业务而言会引起降速，对于 UDP 业务而言可能会导致业务出现卡顿 。同时会引入队头阻塞的问题，导致整体业务时延的增加，进而会导致吞吐量下降。

本文在网关路由器侧对数据包进行一次封装，以便携带序号信息在中继路由器用于保序。此外，利用tcp代理机制，减少乱序导致的tcp业务降速问题 。  

design



中继需求

单频中继存在带宽减半的问题，严重影响用户体验。双频wifi为解决该问题提供了思路。现在虽然 网关路由器 和中继路由器 都支持并发双频，已经具备了使用 2.4 GHz和 5 GHz两个频段进行连接的条件，但是由于无线链路的不稳定性，若要充分发挥双频传输的特性，需要制定合理的链路感知及调度策略，才能保障双频传输能够实现吞吐量聚合的效果，本文的主要内容将围绕能提升聚合链路吞吐量的调度策略展开。为了准确衡量调度策略的功能，这里引入绑定效率 ， 绑定效率就是在输入稳定且流量足够大的情况下汇聚链路实际吞吐量 TP与各链路实际容量 ci之和的比值，即对两条链路的利用率。本文双频融合传输研究的优化目标是尽量使绑定效率 η 达到更大。  



